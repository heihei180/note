<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1. 开发环境搭建 | Heihei&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="LIVE FOR LIVE">
    
    <link rel="preload" href="/note/assets/css/0.styles.ba751174.css" as="style"><link rel="preload" href="/note/assets/js/app.bc58afd5.js" as="script"><link rel="preload" href="/note/assets/js/2.c6b8818e.js" as="script"><link rel="preload" href="/note/assets/js/1.a9a94530.js" as="script"><link rel="preload" href="/note/assets/js/73.03dcb811.js" as="script"><link rel="prefetch" href="/note/assets/js/10.a80dc50e.js"><link rel="prefetch" href="/note/assets/js/100.7898a758.js"><link rel="prefetch" href="/note/assets/js/101.3b322584.js"><link rel="prefetch" href="/note/assets/js/102.de768e2a.js"><link rel="prefetch" href="/note/assets/js/103.d600c6b8.js"><link rel="prefetch" href="/note/assets/js/104.3b1617d1.js"><link rel="prefetch" href="/note/assets/js/105.8f955909.js"><link rel="prefetch" href="/note/assets/js/106.4d870c4f.js"><link rel="prefetch" href="/note/assets/js/107.21b6ca93.js"><link rel="prefetch" href="/note/assets/js/108.df288404.js"><link rel="prefetch" href="/note/assets/js/109.e3b7e1b0.js"><link rel="prefetch" href="/note/assets/js/11.bafc02f8.js"><link rel="prefetch" href="/note/assets/js/110.64ec3f6d.js"><link rel="prefetch" href="/note/assets/js/111.e683ec1f.js"><link rel="prefetch" href="/note/assets/js/112.ddc693b1.js"><link rel="prefetch" href="/note/assets/js/113.2ba676f9.js"><link rel="prefetch" href="/note/assets/js/114.6904631c.js"><link rel="prefetch" href="/note/assets/js/115.7f40322f.js"><link rel="prefetch" href="/note/assets/js/116.b4d26344.js"><link rel="prefetch" href="/note/assets/js/117.46ff2afd.js"><link rel="prefetch" href="/note/assets/js/118.91053e74.js"><link rel="prefetch" href="/note/assets/js/119.c5890562.js"><link rel="prefetch" href="/note/assets/js/12.4b5ad5b9.js"><link rel="prefetch" href="/note/assets/js/120.45859bd8.js"><link rel="prefetch" href="/note/assets/js/121.811229f4.js"><link rel="prefetch" href="/note/assets/js/122.5dd6a5ec.js"><link rel="prefetch" href="/note/assets/js/123.fb889ef5.js"><link rel="prefetch" href="/note/assets/js/124.5479f8b8.js"><link rel="prefetch" href="/note/assets/js/125.50d35273.js"><link rel="prefetch" href="/note/assets/js/126.5266f042.js"><link rel="prefetch" href="/note/assets/js/127.4d65bd96.js"><link rel="prefetch" href="/note/assets/js/128.3bcd9640.js"><link rel="prefetch" href="/note/assets/js/129.f8f60de3.js"><link rel="prefetch" href="/note/assets/js/13.7e492cf4.js"><link rel="prefetch" href="/note/assets/js/130.87b8efda.js"><link rel="prefetch" href="/note/assets/js/131.15eda044.js"><link rel="prefetch" href="/note/assets/js/132.969f33f9.js"><link rel="prefetch" href="/note/assets/js/133.4f7e78d7.js"><link rel="prefetch" href="/note/assets/js/134.4b393c12.js"><link rel="prefetch" href="/note/assets/js/135.bf7fb5ae.js"><link rel="prefetch" href="/note/assets/js/136.2c6fd10c.js"><link rel="prefetch" href="/note/assets/js/137.35ff1520.js"><link rel="prefetch" href="/note/assets/js/138.b63464ec.js"><link rel="prefetch" href="/note/assets/js/139.d49f3044.js"><link rel="prefetch" href="/note/assets/js/14.7d21639b.js"><link rel="prefetch" href="/note/assets/js/140.331af729.js"><link rel="prefetch" href="/note/assets/js/141.4753dfd0.js"><link rel="prefetch" href="/note/assets/js/142.bc7ecfc8.js"><link rel="prefetch" href="/note/assets/js/143.f5625886.js"><link rel="prefetch" href="/note/assets/js/144.cd8ee0aa.js"><link rel="prefetch" href="/note/assets/js/15.38e335b6.js"><link rel="prefetch" href="/note/assets/js/16.87d00f92.js"><link rel="prefetch" href="/note/assets/js/17.893858a3.js"><link rel="prefetch" href="/note/assets/js/18.90116347.js"><link rel="prefetch" href="/note/assets/js/19.2a696a53.js"><link rel="prefetch" href="/note/assets/js/20.23ba6b64.js"><link rel="prefetch" href="/note/assets/js/21.31e32fb9.js"><link rel="prefetch" href="/note/assets/js/22.28c0f387.js"><link rel="prefetch" href="/note/assets/js/23.960f4168.js"><link rel="prefetch" href="/note/assets/js/24.388485e1.js"><link rel="prefetch" href="/note/assets/js/25.4dee267b.js"><link rel="prefetch" href="/note/assets/js/26.6601c45d.js"><link rel="prefetch" href="/note/assets/js/27.068477bb.js"><link rel="prefetch" href="/note/assets/js/28.2d3eaa7a.js"><link rel="prefetch" href="/note/assets/js/29.3c5cd8be.js"><link rel="prefetch" href="/note/assets/js/3.300d7081.js"><link rel="prefetch" href="/note/assets/js/30.643883de.js"><link rel="prefetch" href="/note/assets/js/31.2660f49c.js"><link rel="prefetch" href="/note/assets/js/32.00f8d7ed.js"><link rel="prefetch" href="/note/assets/js/33.785114e9.js"><link rel="prefetch" href="/note/assets/js/34.01f896d9.js"><link rel="prefetch" href="/note/assets/js/35.2bc972c4.js"><link rel="prefetch" href="/note/assets/js/36.374cbd68.js"><link rel="prefetch" href="/note/assets/js/37.d86b41da.js"><link rel="prefetch" href="/note/assets/js/38.bba20d3d.js"><link rel="prefetch" href="/note/assets/js/39.e26bbba2.js"><link rel="prefetch" href="/note/assets/js/4.2e183bf6.js"><link rel="prefetch" href="/note/assets/js/40.b28084bd.js"><link rel="prefetch" href="/note/assets/js/41.a908f1e8.js"><link rel="prefetch" href="/note/assets/js/42.58ee97a8.js"><link rel="prefetch" href="/note/assets/js/43.a8266dd9.js"><link rel="prefetch" href="/note/assets/js/44.cc484174.js"><link rel="prefetch" href="/note/assets/js/45.386017c9.js"><link rel="prefetch" href="/note/assets/js/46.77e32198.js"><link rel="prefetch" href="/note/assets/js/47.748aaeb1.js"><link rel="prefetch" href="/note/assets/js/48.b64fec9e.js"><link rel="prefetch" href="/note/assets/js/49.e75bd648.js"><link rel="prefetch" href="/note/assets/js/5.e50c6310.js"><link rel="prefetch" href="/note/assets/js/50.e70650a5.js"><link rel="prefetch" href="/note/assets/js/51.5e7489cf.js"><link rel="prefetch" href="/note/assets/js/52.89cb2325.js"><link rel="prefetch" href="/note/assets/js/53.771414f2.js"><link rel="prefetch" href="/note/assets/js/54.23afabdf.js"><link rel="prefetch" href="/note/assets/js/55.f07f776e.js"><link rel="prefetch" href="/note/assets/js/56.41247c10.js"><link rel="prefetch" href="/note/assets/js/57.a5ec296f.js"><link rel="prefetch" href="/note/assets/js/58.bbdf58f4.js"><link rel="prefetch" href="/note/assets/js/59.f1e71661.js"><link rel="prefetch" href="/note/assets/js/6.2cf8d884.js"><link rel="prefetch" href="/note/assets/js/60.52964072.js"><link rel="prefetch" href="/note/assets/js/61.5a392f34.js"><link rel="prefetch" href="/note/assets/js/62.8ce765f3.js"><link rel="prefetch" href="/note/assets/js/63.8372725c.js"><link rel="prefetch" href="/note/assets/js/64.53299170.js"><link rel="prefetch" href="/note/assets/js/65.68f7aa21.js"><link rel="prefetch" href="/note/assets/js/66.701c7661.js"><link rel="prefetch" href="/note/assets/js/67.8ebf9a0d.js"><link rel="prefetch" href="/note/assets/js/68.7d81c1a2.js"><link rel="prefetch" href="/note/assets/js/69.c1d1304b.js"><link rel="prefetch" href="/note/assets/js/7.809e3600.js"><link rel="prefetch" href="/note/assets/js/70.66a20ccc.js"><link rel="prefetch" href="/note/assets/js/71.069db039.js"><link rel="prefetch" href="/note/assets/js/72.0a665f14.js"><link rel="prefetch" href="/note/assets/js/74.3bbe2a91.js"><link rel="prefetch" href="/note/assets/js/75.582f539d.js"><link rel="prefetch" href="/note/assets/js/76.30438900.js"><link rel="prefetch" href="/note/assets/js/77.ffde6c2f.js"><link rel="prefetch" href="/note/assets/js/78.212e8a90.js"><link rel="prefetch" href="/note/assets/js/79.c7f72b4a.js"><link rel="prefetch" href="/note/assets/js/80.7a2f5447.js"><link rel="prefetch" href="/note/assets/js/81.8a1dd2cc.js"><link rel="prefetch" href="/note/assets/js/82.9ff0178c.js"><link rel="prefetch" href="/note/assets/js/83.45ce4a7d.js"><link rel="prefetch" href="/note/assets/js/84.1e34f8bb.js"><link rel="prefetch" href="/note/assets/js/85.792f6083.js"><link rel="prefetch" href="/note/assets/js/86.a6791f54.js"><link rel="prefetch" href="/note/assets/js/87.0b133406.js"><link rel="prefetch" href="/note/assets/js/88.310a0bcf.js"><link rel="prefetch" href="/note/assets/js/89.b3de0b66.js"><link rel="prefetch" href="/note/assets/js/90.882dd169.js"><link rel="prefetch" href="/note/assets/js/91.b22f4369.js"><link rel="prefetch" href="/note/assets/js/92.c31987b4.js"><link rel="prefetch" href="/note/assets/js/93.b732c4e4.js"><link rel="prefetch" href="/note/assets/js/94.d456a569.js"><link rel="prefetch" href="/note/assets/js/95.a32c3708.js"><link rel="prefetch" href="/note/assets/js/96.cb24f38a.js"><link rel="prefetch" href="/note/assets/js/97.aaa340bc.js"><link rel="prefetch" href="/note/assets/js/98.54533645.js"><link rel="prefetch" href="/note/assets/js/99.38b20ad1.js"><link rel="prefetch" href="/note/assets/js/vendors~docsearch.a19b1ae9.js">
    <link rel="stylesheet" href="/note/assets/css/0.styles.ba751174.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/note/" class="home-link router-link-active"><!----> <span class="site-name">Heihei's Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/note/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/note/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="https://baidu.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/note/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/note/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="https://baidu.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/note/" aria-current="page" class="sidebar-link">Home</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Guide</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>面试</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Python</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Java</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>JVM</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Jenkins</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>MyBatis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>MySQL</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Netty</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>RocketMQ</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>liteFlow</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>python</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/note/Java/" aria-current="page" class="sidebar-link">Java 技术笔记</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>skywalking</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-2"><p class="sidebar-heading open"><span>skywaling-server</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/note/Java/skywalking/skywaling-server/1. 环境搭建.html" class="active sidebar-link">1. 开发环境搭建</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/Java/skywalking/skywaling-server/1. 环境搭建.html#下载构建" class="sidebar-link">下载构建</a></li><li class="sidebar-sub-header"><a href="/note/Java/skywalking/skywaling-server/1. 环境搭建.html#说明" class="sidebar-link">说明</a></li><li class="sidebar-sub-header"><a href="/note/Java/skywalking/skywaling-server/1. 环境搭建.html#启动" class="sidebar-link">启动</a></li><li class="sidebar-sub-header"><a href="/note/Java/skywalking/skywaling-server/1. 环境搭建.html#elasticsearch-安装与启动" class="sidebar-link">Elasticsearch 安装与启动</a></li><li class="sidebar-sub-header"><a href="/note/Java/skywalking/skywaling-server/1. 环境搭建.html#测试sw" class="sidebar-link">测试SW</a></li></ul></li><li><a href="/note/Java/skywalking/skywaling-server/2. OAP Server启动介绍.html" class="sidebar-link">2. OAP Server启动介绍</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><p class="sidebar-heading"><span>skywalking-java</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>zookeeper</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>技术分析</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>网络代理</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>C#</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CPP</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>toys</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_1-开发环境搭建"><a href="#_1-开发环境搭建" class="header-anchor">#</a> 1. 开发环境搭建</h1> <blockquote><p>Windows 10 环境 IDEA 搭建 <code>skywalking</code> 服务端的源码调试环境。</p></blockquote> <p>参考文档：</p> <p><a href="https://github.com/apache/skywalking/blob/master/docs/en/guides/How-to-build.md" target="_blank" rel="noopener noreferrer">官方文档-GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="下载构建"><a href="#下载构建" class="header-anchor">#</a> 下载构建</h2> <h3 id="下载"><a href="#下载" class="header-anchor">#</a> 下载</h3> <p><strong>Prepare JDK 17 or 21.</strong></p> <ul><li>注意不可以使用Java8来构建</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code>
<span class="token function">git</span> clone --recurse-submodules https://github.com/apache/skywalking.git
<span class="token builtin class-name">cd</span> skywalking/

<span class="token comment"># windows 直接使用本地mvn</span>
mvn clean package <span class="token parameter variable">-Dmaven.test.skip</span>
</code></pre></div><h3 id="构建"><a href="#构建" class="header-anchor">#</a> 构建</h3> <ul><li>构建 sw server</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code>mvn clean compile <span class="token parameter variable">-Dmaven.test.skip</span><span class="token operator">=</span>true
</code></pre></div><h2 id="说明"><a href="#说明" class="header-anchor">#</a> 说明</h2> <p>下载后，编译之后，根据官方文档描述，需要将部分的<code>proto</code> 文件的生成路径加入到源码</p> <ul><li>ref: Setting up your IntelliJ IDEA
NOTE: If you clone the codes from GitHub, please make sure that you have finished steps 1 to 3 in section Build from GitHub. If you download the source codes from the official website of SkyWalking, please make sure that you have followed the steps in section Build from Apache source code release.</li></ul> <ol><li>Import the project as a maven project.</li> <li>Run <code>./mvnw compile -Dmaven.test.skip=true</code> to compile project and generate source codes. The reason is that we use gRPC and protobuf.</li> <li>Set Generated Source Codes folders.</li> <li>以下路径的文件夹，需要加入IDEA的源码路径，右键 <code>mark as source</code>即可
<ul><li><code>grpc-java</code> and <code>java</code> folders in apm-protocol/apm-network/target/generated-sources/protobuf</li> <li><code>grpc-java</code> and <code>java</code> folders in oap-server/server-core/target/generated-sources/protobuf</li> <li><code>grpc-java</code> and <code>java</code> folders in oap-server/server-receiver-plugin/receiver-proto/target/generated-sources/fbs</li> <li><code>grpc-java</code> and <code>java</code> folders in oap-server/server-receiver-plugin/receiver-proto/target/generated-sources/protobuf</li> <li><code>grpc-java</code> and <code>java</code> folders in oap-server/exporter/target/generated-sources/protobuf</li> <li><code>grpc-java</code> and <code>java</code> folders in oap-server/server-configuration/grpc-configuration-sync/target/generated-sources/protobuf</li> <li><code>grpc-java</code> and <code>java</code> folders in oap-server/server-alarm-plugin/target/generated-sources/protobuf</li> <li><code>grpc-java</code> and <code>java</code> folders in oap-server/server-fetcher-plugin/fetcher-proto/target/generated-sources/protobuf</li> <li><code>antlr4</code> folder in oap-server/oal-grammar/target/generated-sources</li></ul></li></ol> <h2 id="启动"><a href="#启动" class="header-anchor">#</a> 启动</h2> <p>根据sky walking 提供的启动脚本观察，需要启动两个服务，并且还有启动参数：</p> <p>共两个类：</p> <ul><li><code>org.apache.skywalking.oap.server.webapp.ApplicationStartUp</code>
添加VM启动参数： <code>-Xms256M -Xmx512M -Doap.logDir=D:\code\github\skywalking-server\skywalking\logs\logs</code></li> <li><code>org.apache.skywalking.oap.server.starter.OAPServerStartUp</code></li></ul> <p>注意再启动OAPserver 之前先修改配置文件<code>oap-server/server-starter/src/main/resources/application.yml</code></p> <p>将里边的<code>storage.selector</code> 改成es， 因为windows 环境无法安装默认的banyanDB, 当然可选的存储还有mysql, pgsql...</p> <h2 id="elasticsearch-安装与启动"><a href="#elasticsearch-安装与启动" class="header-anchor">#</a> Elasticsearch 安装与启动</h2> <blockquote><p>提示，es 新版本不知道如何启动，我下载的es7.3，ES 7.3 需要通过Java8来启动，而sky walking是 JDK17 或者 jdk 21， 所以，需要修改es的启动脚本。</p></blockquote> <p>下载地址：https://www.elastic.co/downloads/past-releases/elasticsearch-7-3-0</p> <ul><li>找到jdk8的路径，比如我这里是： <code>D:\soft\jdks\jdk1.8.0_422\bin\java.exe</code>
打开<code>elasticsearch.bat</code> 文件，将里边的 <code>%JAVA_HOME%</code> 全部替换成 <code>D:\soft\jdks\jdk1.8.0_422\bin\java.exe</code> 即可。</li></ul> <p>这个修改，代表的是不读取系统的Java环境变量，使用的是我们自己定义的Java程序。</p> <ul><li>修改后的部分代码示例：</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code>@echo off

setlocal enabledelayedexpansion
setlocal enableextensions

SET <span class="token assign-left variable">params</span><span class="token operator">=</span><span class="token string">'%*'</span>

:loop
FOR /F <span class="token string">&quot;usebackq tokens=1* delims= &quot;</span> %%A IN <span class="token punctuation">(</span><span class="token operator">!</span>params<span class="token operator">!</span><span class="token punctuation">)</span> DO <span class="token punctuation">(</span>
    SET <span class="token assign-left variable">current</span><span class="token operator">=</span>%%A
    SET <span class="token assign-left variable">params</span><span class="token operator">=</span><span class="token string">'%%B'</span>
	SET <span class="token assign-left variable">silent</span><span class="token operator">=</span>N

	IF <span class="token string">&quot;!current!&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;-s&quot;</span> <span class="token punctuation">(</span>
		SET <span class="token assign-left variable">silent</span><span class="token operator">=</span>Y
	<span class="token punctuation">)</span>
	IF <span class="token string">&quot;!current!&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;--silent&quot;</span> <span class="token punctuation">(</span>
		SET <span class="token assign-left variable">silent</span><span class="token operator">=</span>Y
	<span class="token punctuation">)</span>

	IF <span class="token string">&quot;!silent!&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;Y&quot;</span> <span class="token punctuation">(</span>
		SET <span class="token assign-left variable">nopauseonerror</span><span class="token operator">=</span>Y
	<span class="token punctuation">)</span> ELSE <span class="token punctuation">(</span>
	    IF <span class="token string">&quot;x!newparams!&quot;</span> NEQ <span class="token string">&quot;x&quot;</span> <span class="token punctuation">(</span>
	        SET <span class="token assign-left variable">newparams</span><span class="token operator">=</span><span class="token operator">!</span>newparams<span class="token operator">!</span> <span class="token operator">!</span>current<span class="token operator">!</span>
        <span class="token punctuation">)</span> ELSE <span class="token punctuation">(</span>
            SET <span class="token assign-left variable">newparams</span><span class="token operator">=</span><span class="token operator">!</span>current<span class="token operator">!</span>
        <span class="token punctuation">)</span>
	<span class="token punctuation">)</span>

    IF <span class="token string">&quot;x!params!&quot;</span> NEQ <span class="token string">&quot;x&quot;</span> <span class="token punctuation">(</span>
		GOTO loop
	<span class="token punctuation">)</span>
<span class="token punctuation">)</span>

CALL <span class="token string">&quot;%~dp0elasticsearch-env.bat&quot;</span> <span class="token operator">||</span> <span class="token builtin class-name">exit</span> /b <span class="token number">1</span>
IF ERRORLEVEL <span class="token number">1</span> <span class="token punctuation">(</span>
	IF NOT DEFINED nopauseonerror <span class="token punctuation">(</span>
		PAUSE
	<span class="token punctuation">)</span>
	EXIT /B %ERRORLEVEL%
<span class="token punctuation">)</span>

<span class="token keyword">if</span> not defined ES_TMPDIR <span class="token punctuation">(</span>
  <span class="token keyword">for</span> /f <span class="token string">&quot;tokens=* usebackq&quot;</span> %%a <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>CALL D:<span class="token punctuation">\</span>soft<span class="token punctuation">\</span>jdks<span class="token punctuation">\</span>jdk1.8.0_422<span class="token punctuation">\</span>bin<span class="token punctuation">\</span>java.exe <span class="token parameter variable">-cp</span> <span class="token string">&quot;!ES_CLASSPATH!&quot;</span> <span class="token string">&quot;org.elasticsearch.tools.launchers.TempDirectory&quot;</span><span class="token variable">`</span></span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token builtin class-name">set</span>  <span class="token assign-left variable">ES_TMPDIR</span><span class="token operator">=</span>%%a
<span class="token punctuation">)</span>

<span class="token builtin class-name">set</span> <span class="token assign-left variable">ES_JVM_OPTIONS</span><span class="token operator">=</span>%ES_PATH_CONF%<span class="token punctuation">\</span>jvm.options
@setlocal
<span class="token keyword">for</span> /F <span class="token string">&quot;usebackq delims=&quot;</span> %%a <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>CALL D:<span class="token punctuation">\</span>soft<span class="token punctuation">\</span>jdks<span class="token punctuation">\</span>jdk1.8.0_422<span class="token punctuation">\</span>bin<span class="token punctuation">\</span>java.exe <span class="token parameter variable">-cp</span> <span class="token string">&quot;!ES_CLASSPATH!&quot;</span> <span class="token string">&quot;org.elasticsearch.tools.launchers.JvmOptionsParser&quot;</span> <span class="token string">&quot;!ES_JVM_OPTIONS!&quot;</span> ^<span class="token operator">|</span>^<span class="token operator">|</span> <span class="token builtin class-name">echo</span> jvm_options_parser_failed<span class="token variable">`</span></span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token builtin class-name">set</span> <span class="token assign-left variable">JVM_OPTIONS</span><span class="token operator">=</span>%%a
@endlocal <span class="token operator">&amp;</span> <span class="token builtin class-name">set</span> <span class="token string">&quot;MAYBE_JVM_OPTIONS_PARSER_FAILED=%JVM_OPTIONS%&quot;</span> <span class="token operator">&amp;</span> <span class="token builtin class-name">set</span> <span class="token assign-left variable">ES_JAVA_OPTS</span><span class="token operator">=</span>%JVM_OPTIONS:<span class="token variable">${ES_TMPDIR}</span><span class="token operator">=</span><span class="token operator">!</span>ES_TMPDIR<span class="token operator">!</span>%

<span class="token keyword">if</span> <span class="token string">&quot;%MAYBE_JVM_OPTIONS_PARSER_FAILED%&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;jvm_options_parser_failed&quot;</span> <span class="token punctuation">(</span>
  <span class="token builtin class-name">exit</span> /b <span class="token number">1</span>
<span class="token punctuation">)</span>

D:<span class="token punctuation">\</span>soft<span class="token punctuation">\</span>jdks<span class="token punctuation">\</span>jdk1.8.0_422<span class="token punctuation">\</span>bin<span class="token punctuation">\</span>java.exe %ES_JAVA_OPTS% <span class="token parameter variable">-Delasticsearch</span> <span class="token parameter variable">-Des.path.home</span><span class="token operator">=</span><span class="token string">&quot;%ES_HOME%&quot;</span> <span class="token parameter variable">-Des.path.conf</span><span class="token operator">=</span><span class="token string">&quot;%ES_PATH_CONF%&quot;</span> <span class="token parameter variable">-Des.distribution.flavor</span><span class="token operator">=</span><span class="token string">&quot;%ES_DISTRIBUTION_FLAVOR%&quot;</span> <span class="token parameter variable">-Des.distribution.type</span><span class="token operator">=</span><span class="token string">&quot;%ES_DISTRIBUTION_TYPE%&quot;</span> <span class="token parameter variable">-Des.bundled_jdk</span><span class="token operator">=</span><span class="token string">&quot;%ES_BUNDLED_JDK%&quot;</span> <span class="token parameter variable">-cp</span> <span class="token string">&quot;%ES_CLASSPATH%&quot;</span> <span class="token string">&quot;org.elasticsearch.bootstrap.Elasticsearch&quot;</span> <span class="token operator">!</span>newparams<span class="token operator">!</span>

endlocal
endlocal
<span class="token builtin class-name">exit</span> /b %ERRORLEVEL%

</code></pre></div><p>然后，正常启动ES即可，访问： http://localhost:9200/</p> <h2 id="测试sw"><a href="#测试sw" class="header-anchor">#</a> 测试SW</h2> <p>访问：http://localhost:8080/</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/note/Java/" class="prev router-link-active">
        Java 技术笔记
      </a></span> <span class="next"><a href="/note/Java/skywalking/skywaling-server/2. OAP Server启动介绍.html">
        2. OAP Server启动介绍
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/note/assets/js/app.bc58afd5.js" defer></script><script src="/note/assets/js/2.c6b8818e.js" defer></script><script src="/note/assets/js/1.a9a94530.js" defer></script><script src="/note/assets/js/73.03dcb811.js" defer></script>
  </body>
</html>
