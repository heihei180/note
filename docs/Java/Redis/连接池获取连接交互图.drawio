<mxfile host="Electron" modified="2025-05-26T08:54:37.263Z" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/24.6.1 Chrome/124.0.6367.207 Electron/30.0.6 Safari/537.36" etag="C_blBy3uW9G2KHus4xBD" version="24.6.1" type="device">
  <diagram name="第 1 页" id="Fwu5rDNZS8vyZ63M_4OR">
    <mxGraphModel dx="2641" dy="1746" grid="1" gridSize="18" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="kXtboOUvaUhwJA8joo1L-3" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-1" target="kXtboOUvaUhwJA8joo1L-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-1" value="写操作&lt;div&gt;org.redisson.command.RedisExecutor#execute&lt;br&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="74" y="150" width="340" height="90" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-7" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-2" target="kXtboOUvaUhwJA8joo1L-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-84" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-2" target="kXtboOUvaUhwJA8joo1L-83">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-2" value="获取redis连接&lt;div&gt;getConnection()&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="184" y="335" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-4" value="&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;b&gt;RedisExecutor&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="129" y="36" width="230" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-5" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;&lt;b&gt;ConnectionManager&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="576" y="36" width="230" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-11" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-6" target="kXtboOUvaUhwJA8joo1L-10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-6" value="连接管理器决定是创建读连接还是写连接&lt;div&gt;connectionManager.connectionWriteOp&lt;br&gt;&lt;/div&gt;&lt;div&gt;connectionManager.connectionReadOp&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="504" y="333.5" width="396" height="61.5" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-9" value="&lt;span style=&quot;text-wrap: nowrap; font-size: 17px;&quot;&gt;MasterSlaveConnectionManager&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="576" y="159" width="230" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-16" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-10" target="kXtboOUvaUhwJA8joo1L-15">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-10" value="MasterSlaveConnectionManager#connectionWriteOp" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="541.5" y="522" width="322" height="61.75" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-12" value="以读为例" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="918" y="324" width="90" height="36" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-14" value="&lt;span style=&quot;text-wrap: nowrap; font-size: 17px;&quot;&gt;MasterSlaveEntry&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="1082.5" y="36" width="230" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-19" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-15" target="kXtboOUvaUhwJA8joo1L-18">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-21" value="获取连接" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="kXtboOUvaUhwJA8joo1L-19">
          <mxGeometry x="-0.1264" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-15" value="获取Entry" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="642" y="700.005" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-17" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;&lt;span style=&quot;font-size: 17px; text-align: center; text-wrap: nowrap;&quot;&gt;MasterSlaveEntry&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;&lt;span style=&quot;color: rgba(0, 0, 0, 0.9); font-family: &amp;quot;PingFang SC&amp;quot;, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Ubuntu, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, &amp;quot;Source Han Sans CN&amp;quot;, sans-serif; font-size: 16px; background-color: rgb(252, 252, 252);&quot;&gt;在Redisson中，&lt;/span&gt;&lt;code style=&quot;margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-variant-alternates: inherit; font-variant-position: inherit; font-stretch: inherit; font-size: 14px; line-height: inherit; font-optical-sizing: inherit; font-kerning: inherit; font-feature-settings: inherit; font-variation-settings: inherit; vertical-align: baseline; white-space-collapse: break-spaces; word-break: break-word; color: rgba(0, 0, 0, 0.9); background-color: rgb(252, 252, 252); font-family: ui-monospace, SFMono-Regular, &amp;quot;SF Mono&amp;quot;, Menlo, Consolas, &amp;quot;Liberation Mono&amp;quot;, monospace !important;&quot; class=&quot;hyc-common-markdown__code__inline&quot;&gt;MasterSlaveEntry&lt;/code&gt;&lt;span style=&quot;color: rgba(0, 0, 0, 0.9); font-family: &amp;quot;PingFang SC&amp;quot;, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Ubuntu, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, &amp;quot;Source Han Sans CN&amp;quot;, sans-serif; font-size: 16px; background-color: rgb(252, 252, 252);&quot;&gt;是用于管理Redis主从架构的核心类，负责维护主节点（Master）与从节点（Slave）的连接和路由逻辑.&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgba(0, 0, 0, 0.9); font-family: &amp;quot;PingFang SC&amp;quot;, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Ubuntu, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, &amp;quot;Source Han Sans CN&amp;quot;, sans-serif; font-size: 16px; background-color: rgb(252, 252, 252);&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;即网络连接是由entry管理的。&lt;br&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgba(0, 0, 0, 0.9); font-family: &amp;quot;PingFang SC&amp;quot;, -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Ubuntu, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, &amp;quot;Source Han Sans CN&amp;quot;, sans-serif; font-size: 16px; background-color: rgb(252, 252, 252);&quot;&gt;和slot也有关系，即redis集群的solt怎么分配的？&lt;/span&gt;&lt;/p&gt;" style="text;html=1;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1102.5" y="-162" width="414" height="180" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-24" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-18" target="kXtboOUvaUhwJA8joo1L-23">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-18" value="&lt;div&gt;entry节点获取写连接&lt;/div&gt;MasterSlaveEntry#connectionWriteOp" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1044" y="695.88" width="307" height="64.13" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-22" value="&lt;span style=&quot;font-size: 17px; text-wrap: nowrap;&quot;&gt;MasterConnectionPool&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="1606.5" y="36" width="230" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-26" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-23" target="kXtboOUvaUhwJA8joo1L-25">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-23" value="&lt;div&gt;entry从自己的连接池中获取一个连接&lt;/div&gt;&lt;div&gt;MasterConnectionPool#get&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1568" y="695.88" width="307" height="64.13" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-28" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-25" target="kXtboOUvaUhwJA8joo1L-27">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-25" value="&lt;div&gt;连接池尝试获取连接&lt;/div&gt;&lt;div&gt;ConnectionPool#acquireConnection&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1568" y="840.0099999999999" width="307" height="64.13" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-31" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-27" target="kXtboOUvaUhwJA8joo1L-30">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-27" value="&lt;div&gt;连接池使用自己的客户链接entry尝试获取连接&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1568" y="984.1399999999998" width="307" height="64.13" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-29" value="&lt;span style=&quot;font-size: 17px; text-wrap: nowrap;&quot;&gt;ClientConnectionsEntry&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="2170.5" y="36" width="230" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-33" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-30" target="kXtboOUvaUhwJA8joo1L-32">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-30" value="&lt;div&gt;连接池使用自己的客户链接entry尝试获取连接&lt;/div&gt;&lt;div&gt;ClientConnectionsEntry#acquireConnection&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="2157.5" y="984.1399999999998" width="307" height="64.13" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-36" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-32" target="kXtboOUvaUhwJA8joo1L-35">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-32" value="&lt;div&gt;客户连接entry对象内部使用AsyncSemaphore&lt;/div&gt;&lt;div&gt;来控制连接数量&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="2157.5" y="1153.9399999999996" width="307" height="64.13" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-34" value="&lt;span style=&quot;font-size: 17px; text-wrap: nowrap;&quot;&gt;AsyncSemaphore&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="2620.5" y="36" width="230" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-39" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-35" target="kXtboOUvaUhwJA8joo1L-38">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-35" value="AsyncSemaphore#acquire&lt;br&gt;&lt;div&gt;尝试获取连接&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="2511" y="1372.8599999999997" width="307" height="64.13" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-37" value="注意，这里有一个参数，获取连接资格，就会执行这个回调函数" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=#6c8ebf;fillColor=#dae8fc;" vertex="1" parent="1">
          <mxGeometry x="2493" y="1336.8600000000001" width="378" height="36" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-41" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-38" target="kXtboOUvaUhwJA8joo1L-40">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-38" value="将回调函数添加到队列" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="2511" y="1516.9899999999996" width="307" height="64.13" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-43" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-40" target="kXtboOUvaUhwJA8joo1L-42">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-40" value="尝试获取连接资格&lt;div&gt;tryRun&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="2511" y="1661.1199999999997" width="307" height="64.13" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-45" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-42" target="kXtboOUvaUhwJA8joo1L-44">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-42" value="&lt;div&gt;信号管理这里内部是一个计数器：&lt;/div&gt;&lt;div&gt;AtomicInteger counter;&lt;br&gt;&lt;/div&gt;&lt;div&gt;用于控制线程池的连接数量&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="2511" y="1805.2499999999998" width="307" height="64.13" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-47" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-44" target="kXtboOUvaUhwJA8joo1L-46">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-44" value="counter计数器减一&lt;div&gt;尝试获取资格&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="2604.5" y="1951.445" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-49" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-46" target="kXtboOUvaUhwJA8joo1L-48">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-51" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-46" target="kXtboOUvaUhwJA8joo1L-50">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-46" value="资格获取&lt;div&gt;成功&lt;/div&gt;" style="rhombus;whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="2624.5" y="2081.4449999999997" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-54" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-48" target="kXtboOUvaUhwJA8joo1L-53">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-48" value="获取回调任务&lt;div&gt;如果任务不为空，执行任务&lt;/div&gt;&lt;div&gt;如果任务为空，归还资格，即计数器加一&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="2549.25" y="2232.72" width="230.5" height="71.28" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-52" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.25;entryDx=0;entryDy=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-50" target="kXtboOUvaUhwJA8joo1L-44">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-50" value="获取资格失败&lt;div&gt;则，重复执行&lt;/div&gt;&lt;div&gt;直至获取到资格&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="2799" y="2086.81" width="179" height="69.28" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-57" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-53" target="kXtboOUvaUhwJA8joo1L-56">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-53" value="ConnectionPool#connectTo" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1548" y="2232.72" width="365.37" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-55" value="连接池" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=#6c8ebf;fillColor=#dae8fc;" vertex="1" parent="1">
          <mxGeometry x="1597.4299999999998" y="2196.72" width="72" height="36" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-64" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-56" target="kXtboOUvaUhwJA8joo1L-63">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-66" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-56" target="kXtboOUvaUhwJA8joo1L-65">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-56" value="ConnectionPool#poll&lt;div&gt;仍旧是委托给 clientConnectEntry 去获取连接&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1551.31" y="2460.92" width="358.75" height="59.08" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-62" value="执行回调，获取连接" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="2134.5" y="2286" width="234" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-77" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-63" target="kXtboOUvaUhwJA8joo1L-76">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-63" value="org.redisson.connection.pool.ConnectionPool#connectTo" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1551.31" y="2600" width="358.75" height="59.08" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-68" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-65" target="kXtboOUvaUhwJA8joo1L-67">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-65" value="ClientConnectionsEntry#pollConnection" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="2131" y="2460.92" width="309" height="59.08" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-72" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-67" target="kXtboOUvaUhwJA8joo1L-71">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-67" value="从内部的空闲连接queue（freeConnections）中&lt;div&gt;获取一个连接&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="2131" y="2600" width="309" height="59.08" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-74" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.881;entryY=1.083;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-71" target="kXtboOUvaUhwJA8joo1L-63">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2465.76" y="2768.62" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-75" value="&lt;font style=&quot;font-size: 15px;&quot;&gt;创建好的连接交给连接池&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="kXtboOUvaUhwJA8joo1L-74">
          <mxGeometry x="0.1972" y="1" relative="1" as="geometry">
            <mxPoint x="27" y="-1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-71" value="不为空就添加一下使用次数&lt;div&gt;为null 也不管，直接返回&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="2131" y="2739.08" width="309" height="59.08" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-78" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.25;entryDx=0;entryDy=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-76" target="kXtboOUvaUhwJA8joo1L-2">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-396" y="2827" />
              <mxPoint x="-396" y="350" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-81" value="&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 20px;&quot;&gt;&lt;b&gt;Futrure#complete&amp;nbsp; 标记完成，解除阻塞&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="kXtboOUvaUhwJA8joo1L-78">
          <mxGeometry x="-0.046" y="-2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-76" value="连接创建成功，处理连接成功的连接：&lt;div&gt;ConnectionPool#connectedSuccessful&lt;br&gt;&lt;/div&gt;&lt;div&gt;标记获取连接的future为成功状态，阻塞的future会执行complete或者thanAccept之类的后续操作&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1551.31" y="2798.16" width="358.75" height="59.08" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-82" value="&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;connectionFuture.onComplete((connection, e) -&amp;gt; {&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;// 判断，是否完成，执行过就释放本次获取的连接&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (connectionFuture.isCancelled()) {&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; connectionManager.getShutdownLatch().release();&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; return;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (!connectionFuture.isSuccess()) {&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; connectionManager.getShutdownLatch().release();&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; exception = convertException(connectionFuture);&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; return;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;// 发送命令&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; sendCommand(attemptPromise, connection);&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;// 写操作完成的future 添加监听器写完之后释放连接&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; writeFuture.addListener(new ChannelFutureListener() {&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; @Override&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; public void operationComplete(ChannelFuture future) throws Exception {&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; checkWriteFuture(writeFuture, attemptPromise, connection);&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; });&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 18px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; });&lt;/font&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="-1242" y="278.36" width="702" height="495.28" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-85" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-83" target="kXtboOUvaUhwJA8joo1L-82">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-87" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-83" target="kXtboOUvaUhwJA8joo1L-86">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-83" value="获取连接的future执行" style="ellipse;whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="204" y="475.87" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-89" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-86" target="kXtboOUvaUhwJA8joo1L-88">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-86" value="先判断future是否执行完成，完成就释放连接" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="163.5" y="656" width="161" height="64" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-91" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-88" target="kXtboOUvaUhwJA8joo1L-90">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-88" value="先判断future是否执行完成，完成就释放连接" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="163.5" y="800" width="161" height="64" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-93" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-90" target="kXtboOUvaUhwJA8joo1L-92">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-90" value="发送redis 命令、&lt;div&gt;并且给写请求添加监听器&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="163.5" y="946" width="161" height="62" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-95" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-92" target="kXtboOUvaUhwJA8joo1L-94">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-97" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-92" target="kXtboOUvaUhwJA8joo1L-96">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-92" value="发送命令使用：&lt;div&gt;writeFuture = connection.send&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="184" y="1086" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-94" value="如果主线程池配置的数量小于10个，则每次都释放连接" style="ellipse;whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-106.5" y="1069" width="189" height="94" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-96" value="发送命令使用：&lt;div&gt;writeFuture = connection.send&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="184" y="1218.07" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-102" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-98" target="kXtboOUvaUhwJA8joo1L-101">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-98" value="这里其实也是异步的&lt;div&gt;org.redisson.command.RedisExecutor#releaseConnection&lt;br&gt;&lt;/div&gt;&lt;div&gt;释放连接&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;fillColor=#f8cecc;strokeColor=#b85450;gradientColor=#ea6b66;" vertex="1" parent="1">
          <mxGeometry x="100" y="3024" width="323" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-100" value="如何释放连接？" style="ellipse;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="184" y="1320.6599999999999" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-104" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-101" target="kXtboOUvaUhwJA8joo1L-103">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-101" value="connectManager 仍然委托entry释放连接&lt;div&gt;entry.releaseWrite(connection)&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;fillColor=#f8cecc;strokeColor=#b85450;gradientColor=#ea6b66;" vertex="1" parent="1">
          <mxGeometry x="558" y="3024" width="323" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-106" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-103" target="kXtboOUvaUhwJA8joo1L-105">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-103" value="connectManager 仍然委托entry释放连接&lt;div&gt;entry.releaseWrite(connection)&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;fillColor=#f8cecc;strokeColor=#b85450;gradientColor=#ea6b66;" vertex="1" parent="1">
          <mxGeometry x="1096.5" y="3024" width="323" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-108" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-105" target="kXtboOUvaUhwJA8joo1L-107">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-105" value="&lt;div&gt;entry中的pool&amp;nbsp; 来释放连接&lt;/div&gt;&lt;div&gt;&lt;div style=&quot;background-color:#2b2b2b;color:#a9b7c6&quot;&gt;&lt;pre style=&quot;font-family:&#39;JetBrains Mono&#39;,monospace;font-size:12.0pt;&quot;&gt;&lt;span style=&quot;color:#9876aa;&quot;&gt;writeConnectionPool&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;fillColor=#f8cecc;strokeColor=#b85450;gradientColor=#ea6b66;" vertex="1" parent="1">
          <mxGeometry x="1577.5" y="3025.06" width="323" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-110" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-107" target="kXtboOUvaUhwJA8joo1L-109">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-107" value="pool 又委托给clientConnectEntry 来释放" style="whiteSpace=wrap;html=1;rounded=0;fillColor=#f8cecc;strokeColor=#b85450;gradientColor=#ea6b66;" vertex="1" parent="1">
          <mxGeometry x="1577.5" y="3177.06" width="323" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-112" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="kXtboOUvaUhwJA8joo1L-109" target="kXtboOUvaUhwJA8joo1L-111">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-109" value="clientConnectEntry 将连接添加到&lt;div&gt;freeConnections&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;fillColor=#f8cecc;strokeColor=#b85450;gradientColor=#ea6b66;" vertex="1" parent="1">
          <mxGeometry x="2141.5" y="3177.06" width="323" height="72" as="geometry" />
        </mxCell>
        <mxCell id="kXtboOUvaUhwJA8joo1L-111" value="&lt;div&gt;递减使用次数&lt;/div&gt;&lt;div&gt;这样相当是标记连接可以被服用多次了&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;fillColor=#f8cecc;strokeColor=#b85450;gradientColor=#ea6b66;" vertex="1" parent="1">
          <mxGeometry x="2141.5" y="3025.06" width="323" height="72" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
