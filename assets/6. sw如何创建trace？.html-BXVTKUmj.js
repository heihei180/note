import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as i,d as e,o as n}from"./app-Bnxw6dAd.js";const t={};function l(r,s){return n(),i("div",null,s[0]||(s[0]=[e(`<h1 id="_6-sw如何创建trace" tabindex="-1"><a class="header-anchor" href="#_6-sw如何创建trace"><span>6.sw如何创建trace？</span></a></h1><p>sw的主要功能就说链路跟踪，那么如何创建trace呢？<br> 因为sw可以支持很多种的服务，包括同步线程，异步线程，MySQL，redis.</p><p>sw 是如何通过trace将不同的链路追踪，串联起来的呢？</p><p>这里通过http请求，来举例研究。</p><h2 id="_1-创建trace" tabindex="-1"><a class="header-anchor" href="#_1-创建trace"><span>1. 创建Trace</span></a></h2><h3 id="_1-1-创建测试环境" tabindex="-1"><a class="header-anchor" href="#_1-1-创建测试环境"><span>1.1 创建测试环境</span></a></h3><p>首先，我们需要创建一个测试环境，创建一个简单的spring mvc 的controller 用于提供Http服务</p><p>这个接口接收一个参数，将其存入redis，然后在从redis读取出来，返回给浏览器客户端。</p><p>那么可以考虑这个过程，有以下几个操作：</p><ol><li>接收请求</li><li>存入redis</li><li>从redis读取</li><li>返回结果</li></ol><h3 id="_1-2-启动调试环境-断点来看。" tabindex="-1"><a class="header-anchor" href="#_1-2-启动调试环境-断点来看。"><span>1.2 启动调试环境，断点来看。</span></a></h3><p>D:\\code\\github\\sw-learn<br> -javaagent:D:\\code\\github\\sw-learn\\skywalking-java\\skywalking-agent\\skywalking-agent.jar<br> -javaagent:D:/code/github/sw-learn/skywalking-java/skywalking-agent/skywalking-agent.jar</p><p>首先记得，重新compile以下 agent 的源码，因为如果你修改了的话，不重新compile的话，有些源码会对不上。<br><code>PS D:\\code\\github\\sw-learn\\skywalking-java&gt; mvn clean install -DskipTests</code><br><code>./mvnw clean package -Pall</code></p><p>或者说，如果源码调试的时候和代码匹配补上，那么手动选择一下源码，chosse source code， 将原来的 mvn lib 改成当前工程中 sw-java的源码目录。</p><p>将 sky walking的check Style 关闭，他不让写中文注释。</p><p>D:\\code\\github\\sw-learn\\skywalking-java\\pom.xml</p><p>将失败改成false</p><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-xml"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">&lt;!--        &lt;checkstyle.fails.on.error&gt;true&lt;/checkstyle.fails.on.error&gt;--&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">&lt;!--        close check style plugin--&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">checkstyle.fails.on.error</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;false&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">checkstyle.fails.on.error</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[INFO] There are 102 errors reported by Checkstyle 9.3 with D:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ode</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\g</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ithub</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">w-learn</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">kywalking-java/apm-checkstyle/checkStyle.xml ruleset.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[ERROR] src</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\m</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ain</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\j</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ava</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\o</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">rg</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">pache</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">kywalking</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">pm</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">gent</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ore</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\b</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">oot</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\O</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">verrideImplementor.java:[30] (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">regexp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) RegexpSingleline: Not allow chinese character !</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[ERROR] </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">src\\main\\java\\org\\apache\\skywalking\\apm\\agent\\core\\boot\\OverrideImplementor.java:[31]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (regexp) RegexpSingleline: Not allow chinese character !</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[ERROR] </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">src\\main\\java\\org\\apache\\skywalking\\apm\\agent\\core\\boot\\OverrideImplementor.java:[32]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (regexp) RegexpSingleline: Not allow chinese character !</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[ERROR] </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">src\\main\\java\\org\\apache\\skywalking\\apm\\agent\\core\\boot\\OverrideImplementor.java:[33]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (regexp) RegexpSingleline: Not allow chinese character !</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[ERROR] </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">src\\main\\java\\org\\apache\\skywalking\\apm\\agent\\core\\boot\\OverrideImplementor.java:[35]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (regexp) RegexpSingleline: Not allow chinese character !</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[ERROR] </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">src\\main\\java\\org\\apache\\skywalking\\apm\\agent\\core\\boot\\OverrideImplementor.java:[36]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (regexp) RegexpSingleline: Not allow chinese character !</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="redis-写数据拦截器" tabindex="-1"><a class="header-anchor" href="#redis-写数据拦截器"><span>Redis 写数据拦截器</span></a></h1><p>org.apache.skywalking.apm.plugin.lettuce.v5.RedisChannelWriterInterceptor</p><h2 id="创建span" tabindex="-1"><a class="header-anchor" href="#创建span"><span>创建span</span></a></h2><p>org.apache.skywalking.apm.agent.core.context.ContextManager#createExitSpan(java.lang.String, java.lang.String)</p><h2 id="springmvc" tabindex="-1"><a class="header-anchor" href="#springmvc"><span>SpringMVC</span></a></h2><p>org.apache.skywalking.apm.plugin.spring.mvc.commons.interceptor.AbstractMethodInterceptor</p>`,25)]))}const k=a(t,[["render",l]]),c=JSON.parse('{"path":"/Java/skywalking/skywalking-java/6.%20sw%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BAtrace%EF%BC%9F.html","title":"6.sw如何创建trace？","lang":"zh-CN","frontmatter":{"description":"6.sw如何创建trace？ sw的主要功能就说链路跟踪，那么如何创建trace呢？ 因为sw可以支持很多种的服务，包括同步线程，异步线程，MySQL，redis. sw 是如何通过trace将不同的链路追踪，串联起来的呢？ 这里通过http请求，来举例研究。 1. 创建Trace 1.1 创建测试环境 首先，我们需要创建一个测试环境，创建一个简单的s...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"6.sw如何创建trace？\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-08-04T07:01:30.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"heihei180\\",\\"url\\":\\"https://github.com/heihei180\\"}]}"],["meta",{"property":"og:url","content":"https://vuepress-theme-hope-docs-demo.netlify.app/note/Java/skywalking/skywalking-java/6.%20sw%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BAtrace%EF%BC%9F.html"}],["meta",{"property":"og:site_name","content":"筆記本首頁"}],["meta",{"property":"og:title","content":"6.sw如何创建trace？"}],["meta",{"property":"og:description","content":"6.sw如何创建trace？ sw的主要功能就说链路跟踪，那么如何创建trace呢？ 因为sw可以支持很多种的服务，包括同步线程，异步线程，MySQL，redis. sw 是如何通过trace将不同的链路追踪，串联起来的呢？ 这里通过http请求，来举例研究。 1. 创建Trace 1.1 创建测试环境 首先，我们需要创建一个测试环境，创建一个简单的s..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-08-04T07:01:30.000Z"}],["meta",{"property":"article:modified_time","content":"2025-08-04T07:01:30.000Z"}]]},"git":{"createdTime":1754290890000,"updatedTime":1754290890000,"contributors":[{"name":"wanggq10","username":"wanggq10","email":"wanggq10@lenovo.com","commits":1,"url":"https://github.com/wanggq10"}]},"readingTime":{"minutes":1.76,"words":528},"filePathRelative":"Java/skywalking/skywalking-java/6. sw如何创建trace？.md","autoDesc":true}');export{k as comp,c as data};
